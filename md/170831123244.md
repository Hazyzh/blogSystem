{
"title":"构建自己的博客",
"keywords":"node博客系统，个人博客",
"tags":"个人博客",
"relationBlog":"",
"time":"2017年08月31日 12:32:44"
}

### 前言

自己之前想实践 `nodejs` 项目，就买了一个百度的 [bae](https://cloud.baidu.com/product/bae.html?track=cp:nsem|pf:pc|pp:bae|pu:brand|ci:|kw:33331) 在上面部署我的node项目,自带`CICD` 感觉还是很方便，服务器什么的都不用管，直接发布了就好了，后来慢慢感觉到很多限制，比如 `node` 的版本被限制死了，发布出错时候不容易查到原因，想修改一个 `npm` 包源码内容时候也很难实现。

正好 [阿里云](https://www.aliyun.com/) 有个9元建站的活动，就买了一个服务器，自己搭建服务器还是很艰难的，用的 ` CentOS 6.8` ,之前没接触过 `linux` 搭环境按软件的过程还是很 **酸爽**
的,这里先不提了，搭好之后直接用 `node8` ,大部分 `es6` 语法都不用去 `babel` 转了 感觉很棒。有环境了就想着去折腾

### 博客想法

和大部分人一样，想着自己先建一个博客吧。用服务器就是为了实践 `nodejs`, 所以 `WordPress` 之类的不会去考虑了，后面有去了解到 [hexo](https://hexo.io/) 和 [ghost](https://ghost.org/), 看了看感觉都很棒。自己去实践了一下，搭起来感觉还行，但是要改一些样式配置之类的，要去看很多配置文件的意义，对我个人来说去研究这些配置文件是很心累的事情。

自己做博客就是想静静的展示一些文章,没有什么样式、炫酷特效的要求。后面一想与其去研究配置文件不如自己搞一个简单的算啦。想了一下自己的需求

 - 简单，等后面自己折腾不动了还可以保留这些资料 -- (markdown文稿)

 - 清爽，自己设计能力也不强，但是模仿别人也好至少要做的页面看起来简洁一点。

 - 折腾，博客首页可以简单做个展示，详情页里面要添加一些自己想实践的元素，在线交流、用户验证评论、关联展示等..

### 思路

![思路](//hazyzh.oss-cn-shenzhen.aliyuncs.com/imgs/%E5%8D%9A%E5%AE%A2%E6%80%9D%E8%B7%AF.png)

博客核心就是内容页，自己大概思路就是这些，命令生成一个新的 `md` 文件，其中包含后面需要的配置信息，然后写好内容后在根据内容生成静态html文件放到自己的站点上。对于内容页的样式有过一个大概的规划

![内容页](//hazyzh.oss-cn-shenzhen.aliyuncs.com/imgs/idea.png)

### 技术选型

- 生成 `md` 文件时候基本的配置信息 `hexo` 用的 `YAML` 写入配置在文章的顶部，自己做图方便直接生成一个 `JSON` 对象仍在顶部，到后面解析时候直接正则匹配出来。内容信息存储直接用买服务器时候送的 `mysql` 来存了。

- 写入文章内容，标题和时间会在配置生成时候写入后面解析也会添加到静态页面中，`md` 正文中直接写自己要写到内容即可，段落标题后面解析时候只匹配了 `h3 -> ###` 和 `h4 -> ####` 标题做为目录信息。

- 解析文件内容。看了一些 `md` 解析的库，最后选择用 [marked](https://github.com/chjj/marked),解析时候处了常规配置，语法高亮用了[highlight](https://github.com/isagalaev/highlight.js)给代码片段加入语法高亮，自己写了 `h 标签` 的 render规则，给 `h3` 和 `h4` 加了自己的 `id` 值,后面用来生成目录导航。

- 附加功能：因为自己熟悉 `react`， 也想多练习就用 `react` 写附加功能模块，组件用了 [antd](https://ant.design/index-cn) 的一些组建。

	- 关于导航考虑到后面首页可能还会用这些信息，自己没有在页面上直接写入，而是把信息存在数据库进入页面时候取出来展示。

	- 聊天区域正好后台用的 `nodejs` 就选择了[socket.io](https://github.com/socketio/socket.io/)来接入聊天功能，聊天用户名则是根据登入 `ip` 地址城市随机生成,定位信息来自 [高德地图](//lbs.amap.com/)。

	- 评论区域，自己把生成的评论存入数据库，评论登入调用了 [微博登录授权](//open.weibo.com/)，授权成功用 [jwt](https://jwt.io/) 生成 `token` 用于后续鉴权，自己的评论可以在一定时间段内删除,增加和删除加入了一些 [animate.css](https://daneden.github.io/animate.css/) 的动画。
  
- 后台信息数据存储就直接用 `nodejs` 的 [mysql](https://github.com/mysqljs/mysql) 模块，接口交互则用了比较方便的 [express](//www.expressjs.com.cn/)
